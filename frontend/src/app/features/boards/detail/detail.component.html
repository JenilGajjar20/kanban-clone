<div>
  <a
    [routerLink]="['/boards']"
    routerLinkActive="router-link-active"
    mat-flat-button
    color="secondary"
  >
    Go Back
  </a>
</div>

<h2>{{ board()?.name }}</h2>

<div
  cdkDropListGroup
  cdkDropList
  cdkDropListOrientation="horizontal"
  (cdkDropListDropped)="onSwimlaneChange($event)"
  class="swimlane-wrapper"
>
  @for(swimlane of board()?.swimlanes; track swimlane.id){
  <div class="swimlane" cdkDrag>
    <div class="swimlane-header" cdkDragHandle>
      <h4>{{ swimlane.name }}</h4>
      <button
        (click)="deleteSwimlane(swimlane)"
        class="delete_btn"
        color="secondary"
        mat-button
      >
        Bin
      </button>
    </div>
    <div class="swimlane-inner">
      <div
        class="swimlane-inner__dragzone"
        cdkDropList
        cdkDropListOrientation="vertical"
        [cdkDropListData]="swimlane.cards"
        (cdkDropListDropped)="onCardChange($event, swimlane)"
      >
        @for(card of swimlane.cards; track card.id){
        <div class="swimlane-card" cdkDrag>
          {{ card.name }}
        </div>
        }
      </div>
    </div>
    <button (click)="addCard(swimlane)" color="secondary" mat-button>
      Add Card
    </button>
  </div>
  }

  <div class="swimlane">
    <h4>Add Swimlane</h4>
    <div class="swimlane-inner add-swimlane-form">
      <form [formGroup]="swimlaneForm" (keyup.enter)="addSwimlane()">
        <mat-form-field>
          <mat-label>Name</mat-label>
          <input
            type="text"
            matInput
            formControlName="name"
            placeholder="Add a Todo"
          />

          @if(!swimlaneForm.controls.name.hasError('required')){
          <mat-error>Please enter the valid name</mat-error>
          }
        </mat-form-field>
      </form>
      <!-- <br /> -->
      <!-- <button color="primary" class="add_swimlane" mat-flat-button>Add</button> -->
    </div>
  </div>
</div>
